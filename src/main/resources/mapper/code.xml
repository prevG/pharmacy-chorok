<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.pharm.chorok.web.admin.repository.ADCodeRepository">


	<select id="selectCodesByGroupCd" parameterType="com.pharm.chorok.domain.table.TbCommCode" resultType="com.pharm.chorok.domain.table.TbCommCode">
		SELECT GRP_CD,
			DITC_CD,
			DITC_NM,
			CONCAT('[',DITC_CD,']',DITC_NM) AS DITC_CD_NM,
			DITC_NM_ENG,
			VALUE_CD,
			VALUE_CD2,
			CD_EXP,
			CD_EXP_ENG,
			V_ORDER,
			LOCK_YN,
			USE_YN,
			REG_ID,
			REG_DTTM,
			UPD_ID,
			UPD_DTTM
		  FROM TB_COMM_CODE
		 WHERE 1=1
		 <if test='target!=null and target.equals("grid")'>
		 <![CDATA[
		 AND DITC_CD <> '00000'
		 ]]>
		 </if>
		 AND GRP_CD = #{grpCd}
		 <choose>
			<when test='srchKind != null and srchKind.equals("ko")'>
			 AND DITC_NM like concat('%',#{srchTxt},'%')
			</when>
			<when test='srchKind != null and srchKind.equals("en")'>
			 AND DITC_NM_ENG like concat('%',#{srchTxt},'%')
			</when>
		</choose>
		 <if test='useYn!=null and !useYn.equals("A")'>
		 AND USE_YN = #{useYn}
		 </if>
		 ORDER BY V_ORDER
	</select>
	
	<update id="updateCode" parameterType="com.pharm.chorok.domain.table.TbCommCode">
		UPDATE TB_COMM_CODE
		SET USE_YN = 'N'
		WHERE 1=1
		AND GRP_CD = #{grpCd}
		<if test='ditcCd!=null'>
		AND DITC_CD = #{ditcCd}
		</if>
	</update>
	
	
	<delete id="removeCode" parameterType="com.pharm.chorok.domain.table.TbCommCode">
		DELETE FROM TB_COMM_CODE
		WHERE 1=1
		AND GRP_CD = #{grpCd}
		<if test='ditcCd!=null'>
		AND DITC_CD = #{ditcCd}
		</if>
	</delete>	

	<insert id="saveCode" parameterType="com.pharm.chorok.domain.table.TbCommCode">
		INSERT INTO TB_COMM_CODE
		(	GRP_CD,
			DITC_CD,
			DITC_NM,
			DITC_NM_ENG,
			VALUE_CD,
			VALUE_CD2,
			CD_EXP,
			CD_EXP_ENG,
			V_ORDER,
			LOCK_YN,
			USE_YN,
			REG_ID,
			REG_DTTM,
			UPD_ID,
			UPD_DTTM
		)
		VALUES
		(	#{grpCd},
			#{ditcCd},
			#{ditcNm},
			#{ditcNmENG},
			#{valueCd},
			#{valueCd2},
			#{cdExp},
			#{cdExpEnG},
			#{vOrder},
			#{lockYn},
			#{useYn},
			#{regId},
			#{regDttm},
			#{updId},
			#{updDttm}
		)
			
	</insert>
	
	
</mapper>